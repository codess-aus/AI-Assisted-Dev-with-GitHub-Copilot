<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Establish guardrails for the ByteStrike blueprint mission. Harden Python, JavaScript, and C# decoders with validation, retries, and tests.">
    <title>Part 5: Security & Quality Guardrails - Developer FAQ</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <a href="../index.html" class="back-link">← Back to Workshop</a>
                <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
                    <svg class="sun-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <svg class="moon-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <article class="container post-content">
        <div class="post-hero">
            <img src="../images/GHAS.png" alt="Security and Quality: Guardrails for AI-Generated Code" loading="eager">
        </div>
        <div class="post-header">
            <div class="post-date">Part 5</div>
            <h1 class="post-title">Security and Quality: Guardrails for AI-Generated Code</h1>
        </div>

        <div class="post-body">
            <h2>Guardrails for the ByteStrike Mission</h2>
            <p>We will harden the blueprint decoders from Part 4 across Python, JavaScript, and C#. Add validation, timeouts, retries, caps, logging, and tests so the League secrets stay safe.</p>

            <h2>Learning Objectives</h2>
            <ul>
                <li>Spot and patch security/quality gaps in AI-generated code</li>
                <li>Add guardrails: validation, retries, timeouts, caps, logging, and tests</li>
                <li>Practice secure-by-default prompting in Chat and Agent Mode</li>
            </ul>

            <h2>Guardrail Checklist</h2>
            <ul>
                <li>Validate inputs (URL/host), set timeouts, retry with backoff</li>
                <li>Precompile regex, cap bytes read, limit number/length of secrets</li>
                <li>Structured logging and clear error messages</li>
                <li>Tests for happy path, failure path, and empty payload</li>
            </ul>

            <h2>Language Tabs — Harden from Here</h2>
            <div class="language-tabs">
                <button class="language-tab active" data-language="python">Python</button>
                <button class="language-tab" data-language="javascript">JavaScript</button>
                <button class="language-tab" data-language="csharp">C#</button>
            </div>

            <div class="tab-content-container">
                <div class="tab-content active" data-language="python">
<pre><code>import re
import requests

SECRET_PATTERN = re.compile(r"\{\*(.*?)\*\}")

def retrieve_and_decode_blueprint(blueprint_url, max_secrets=10):
    # TODO: validate URL/host, add retries/backoff, cap total bytes
    response = requests.get(blueprint_url, timeout=10)
    response.raise_for_status()

    secrets = SECRET_PATTERN.findall(response.text)[:max_secrets]
    if not secrets:
        print("No authentic secrets found. The League's decoys were strong!")
        return

    for idx, secret in enumerate(secrets, 1):
        print(f"Secret #{idx}: {secret.strip()[:200]}")
</code></pre>
                </div>

                <div class="tab-content" data-language="javascript">
<pre><code>const secretPattern = /\{\*(.*?)\*\}/g;

async function retrieveAndDecodeBlueprint(url, maxSecrets = 10) {
    // TODO: validate URL/host, add timeout + retry with backoff
    const controller = new AbortController();
    const timeout = setTimeout(() => controller.abort(), 10000);

    const response = await fetch(url, { signal: controller.signal });
    clearTimeout(timeout);
    if (!response.ok) throw new Error(`Fetch error: ${response.status}`);

    const text = await response.text();
    const secrets = [...text.matchAll(secretPattern)]
        .map(m => m[1].trim())
        .slice(0, maxSecrets);

    if (!secrets.length) {
        console.log("No League secrets found. All data may be decoys!");
        return;
    }

    secrets.forEach((secret, idx) => console.log(`Secret #${idx + 1}: ${secret.slice(0, 200)}`));
}
</code></pre>
                </div>

                <div class="tab-content" data-language="csharp">
<pre><code>using System.Net.Http;
using System.Text.RegularExpressions;

public class LeagueHQ
{
    private static readonly Regex SecretPattern = new("\{\*(.*?)\*\}", RegexOptions.Compiled);

    private static async Task RetrieveAndDecodeBlueprint(string url, int maxSecrets = 10)
    {
        // TODO: validate URL/host, add HttpClient timeout + retry policy
        using var httpClient = new HttpClient { Timeout = TimeSpan.FromSeconds(10) };
        var blueprintContent = await httpClient.GetStringAsync(url);

        var matches = SecretPattern.Matches(blueprintContent);
        if (matches.Count == 0)
        {
            Console.WriteLine("No League secrets found. All data may be decoys!");
            return;
        }

        int printed = 0;
        foreach (Match match in matches)
        {
            if (printed >= maxSecrets) break;
            var value = match.Groups[1].Value.Trim();
            Console.WriteLine($"Secret #{printed + 1}: {value.Substring(0, Math.Min(200, value.Length))}");
            printed++;
        }
    }
}
</code></pre>
                </div>
            </div>

            <h2>Lab 5: Harden the Blueprint Decoders</h2>
            <h3>1) Threat-model quickly</h3>
            <ul>
                <li>What can go wrong? Unbounded input, slow network, hostile URL, huge secrets.</li>
            </ul>

            <h3>2) Add guardrails in your language</h3>
            <ul>
                <li>Implement URL/host validation, timeouts, and a 2-try exponential backoff.</li>
                <li>Cap bytes read, limit secrets to 10, truncate to 200 chars.</li>
                <li>Add structured logging for success/failure and reason codes.</li>
            </ul>

            <h3>3) Test and verify</h3>
            <ul>
                <li>Write one happy-path test and one failure-path test (timeout/404).</li>
                <li>In Agent Mode, ask it to propose tests; in Chat, ask for a quick refactor.</li>
            </ul>

            <h3>4) Share learnings</h3>
            <ul>
                <li>Capture the guardrails you added and which were easiest/hardest with Copilot.</li>
            </ul>
        </div>

        <div class="post-navigation">
            <a href="part4-chat-agent-mode.html" class="previous-post">← Previous: Part 4 - Chat vs Agent Mode</a>
            <a href="part6-production-workflows.html" class="next-post">Next: Part 6 - Production Workflows →</a>
        </div>
    </article>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2026 Developer FAQ. All rights reserved.</p>
        </div>
    </footer>

    <script src="../script.js"></script>
</body>
</html>
